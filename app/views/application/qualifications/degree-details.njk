{% extends "_form.njk" %}

{% set parent = "Academic qualifications" %}
{% if action == "edit" %}
  {% set title = "Edit non-UK degree" if international else "Edit degree" %}
  {% set buttonText = "Save changes" %}
{% else %}
  {% set title = "Add non-UK degree" if international else "Add degree" %}
  {% set buttonText = "Save and continue" %}
{% endif %}

{% block primary %}
{% if international == true %}
  <p class="govuk-body-l">If you studied for your degree outside the UK, you will need to check that it is valid here.</p>
  <p class="govuk-body">Enter the details of your degree as they appear on your certificate, translating them into English if necessary.</p>
  <h3 class="govuk-heading-s">Before you submit your application</h3>
  <p class="govuk-body">Contact your chosen training provider to check their policy on non-UK qualifications.</p>
  <p class="govuk-body">Consider registering at GOV.UK’s <a href="https://getintoteaching.education.gov.uk">Get into Teaching</a>. Registration will give you access to phone and email support from a teacher training advisor (TTA). Your TTA can tell you if your degree makes you eligible for teacher training and how it corresponds to a UK degree.</p>
  <hr class="govuk-section-break govuk-section-break--l govuk-section-break--visible">
{% else %}
  <p class="govuk-body">Individual training providers set specific requirements for their courses. Contact your chosen training provider to check your degree meets the standard they’ve set for your course.</p>
{% endif %}

  {{ govukInput({
    label: {
      text: "Type of degree",
      classes: "govuk-label--s"
    },
    hint: {
      text: "For example, BA, BSc, Masters, Phd, or other (please specify)."
    }
  } | decorateApplicationAttributes(['qualifications', id, "type"])) }}

  {{ govukInput({
    label: {
      text: "Subject of degree",
      classes: "govuk-label--s"
    }
  } | decorateApplicationAttributes(['qualifications', id, "subject"])) }}

  {{ govukInput({
    label: {
      text: "Institution where you studied",
      classes: "govuk-label--s"
    }
  } | decorateApplicationAttributes(['qualifications', id, "institution"])) }}

{% if international == true %}
  {{ appAutocomplete({
    label: {
      text: "In which country did you gain this degree?",
      classes: "govuk-label--s"
    },
    items: countries
  } | decorateApplicationAttributes(['qualifications', id, "country"])) }}
{% else %}
  {{ govukInput({
    type: "hidden",
    name: "applications[" + applicationId + "][qualifications][" + id + "][country]",
    value: "United Kingdom"
  }) }}
{% endif %}

{% if international == true %}
  {{ govukInput({
    label: {
      text: "Degree grade",
      classes: "govuk-label--s"
    },
    hint: {
      text: "If you are still studying, give us your predicted grade. Predicted grades must be validated by an academic referee (see ‘References’)."
    },
    classes: "govuk-input--width-10"
  } | decorateApplicationAttributes(['qualifications', id, "grade"])) }}
{% else %}
  {% set otherGradeHtml %}
    {{ govukInput({
      label: {
        text: "Please specify class of degree"
      }
    } | decorateApplicationAttributes(['qualifications', id, "grade-other"])) }}
  {% endset %}
  {% set predictedGradeHtml %}
    {{ govukInput({
      label: {
        text: "Please give details of your predicted grade"
      },
      hint: {
        text: "You must choose an academic referee (in the ‘References’ section) who can validate it."
      }
    } | decorateApplicationAttributes(['qualifications', id, "grade-predicted"])) }}
  {% endset %}

  {{ govukRadios({
    fieldset: {
      legend: {
        text: "Class of degree",
        classes: "govuk-label--s"
      }
    },
    items: [{
      text: "First"
    }, {
      text: "Upper second (2:1)"
    }, {
      text: "Lower second (2:2)"
    }, {
      text: "Third"
    }, {
      text: "Other",
      conditional: {
        html: otherGradeHtml
      }
    }, {
      divider: "or"
    }, {
      value: "Pending",
      text: "I am still studying for my degree",
      conditional: {
        html: predictedGradeHtml
      }
    }]
  } | decorateApplicationAttributes(['qualifications', id, "grade"])) }}
{% endif %}

  {{ govukInput({
    label: {
      text: "Year qualification was awarded",
      classes: "govuk-label--s"
    },
    hint: {
      text: "If you are still studying, give us the date of your graduation. You must have successfully graduated by the time you start your course."
    },
    classes: "govuk-input--width-4"
  } | decorateApplicationAttributes(['qualifications', id, "year"])) }}

{% if international == true %}
  <hr class="govuk-section-break govuk-section-break--l govuk-section-break--visible">
  {% set validateNaricHtml %}
    {{ govukInput({
      label: {
        text: "What UK degree is your degree comparable to?"
      }
    } | decorateApplicationAttributes(['qualifications', id, "naric-details"])) }}
  {% endset -%}

  {{ govukRadios({
    fieldset: {
      legend: {
        text: "Have you got a NARIC statement of comparability?",
        classes: "govuk-fieldset__legend--s"
      }
    },
    hint: {
      html: "<a href=\"https://www.naric.org.uk/naric/Default.aspx/\">UK NARIC</a> gives advice on non-UK academic, vocational and professional qualifications. If you have applied to UK NARIC for a <a href=\"https://www.naric.org.uk/naric/Individuals/Compare%20Qualifications/Statement%20of%20Comparability.aspx/\">statement of comparability</a>, give details here."
    },
    items: [{
      text: "Yes",
      conditional: {
        html: validateNaricHtml
      }
    }, {
      text: "No"
    }]
  } | decorateApplicationAttributes(['qualifications', id, "naric"])) }}
{% endif %}

{% if action != "edit" %}
  {{ govukButton({
    text: "Save and add another degree",
    classes: "govuk-button--secondary",
    attributes: {
      formaction: "/application/" + applicationId + "/qualifications/add/degree"
    }
  }) }}
{% endif %}
  {{ govukButton({
    text: buttonText
  }) }}
{% endblock %}

{% if international == true %}
  {% block pageScripts %}
    {% set defaultValue = data.applications[applicationId]["qualifications"][id]["country"] %}
    <script src="/public/javascripts/autocomplete.min.js"></script>
    <script>
      accessibleAutocomplete.enhanceSelectElement({
        defaultValue: '{{ data.applications[applicationid]["qualifications"][id]["country"] }}',
        selectElement: document.querySelector('#qualifications-{{ id }}-country')
      })
    </script>
  {% endblock %}
{% endif %}
