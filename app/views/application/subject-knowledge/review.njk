{% extends "_form-wide.njk" %}

{% set applicationPath = "/application/" + applicationId %}
{% set formaction = applicationPath %}
{% set referrer = applicationPath + "/subject-knowledge/review" %}
{% set title = "Your suitability to teach a subject or age group" %}
{% set allowsFeedback = true %}
{% set canAmend = true %}

{% block pageNavigation %}
  {{ govukBackLink({
    href: applicationPath,
    text: "Back to application"
  }) }}
{% endblock %}

{% block primary %}
  {% include "_includes/review/subject-knowledge.njk" %}

  {% set hasFeedbackFromPreviousApplication = false %}
  {% if applicationValue(["apply2"]) %}
    {% for previousApplicationId in applicationValue("previousApplications") %}
      {% for item in (data.applications[previousApplicationId].choices | toArray) %}
        {% if item.feedback and item.feedback.qualityOfApplication and item.feedback.qualityOfApplication.subjectKnowledge %}
          {% set hasFeedbackFromPreviousApplication = true %}
        {% endif %}
      {% endfor %}
    {% endfor %}
  {% endif %}

  {{ govukCheckboxes({
    items: [{
      value: "true",
      text: "I have " + ("reviewed" if hasFeedbackFromPreviousApplication else "completed") + " this section"
    }]
  } | decorateApplicationAttributes(["completed", "subjectKnowledge"])) }}

  {{ govukButton({
    text: "Continue"
  }) }}
{% endblock %}
