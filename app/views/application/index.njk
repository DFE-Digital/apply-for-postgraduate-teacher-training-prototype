{% extends "_content.njk" %}
{% set applicationPath = "/application/" + applicationId %}
{% set status = applicationValue(["status"]) %}
{% if status == "started" %}
  {% set title = "Your application" %}
  {% set tagClass = "app-tag--completed" %}
  {% set tagText = "Completed" %}
  {% set reviewText = "Check your answers before submitting" %}
{% elif status == "amending" %}
  {% set title = "Edit your application" %}
  {% set tagClass = "app-tag--unamended" %}
  {% set tagText = "Unedited" %}
  {% set reviewText = "Check your changes before submitting" %}
{% endif %}
{% set hasSecondary = true %}

{% block pageNavigation %}
  {% if hasSubmittedApplications() %}
    {{ govukBreadcrumbs({
      items: [{
        text: "Application dashboard",
        href: "/applications" + ("?state=isWithinAmendPeriod" if status == "amending")
      }, {
        text: title | safe
      }]
    }) }}
  {% endif %}
{% endblock %}

{% block primary %}
  {{ govukWarningText({
    text: "You have 5 days remaining (until " + (5 | nowPlusDays("d MMMM yyyy")) + ") to resubmit your edited application",
    iconFallbackText: "Warning"
  }) if status == "amending" }}
  <h2 class="govuk-heading-m govuk-!-font-size-27 govuk-!-margin-bottom-2">Course choices</h2>
  {{ appTaskList({
    classes: "govuk-!-margin-bottom-8",
    items: [{
      text: "Course choices",
      href: applicationPath + "/choices",
      id: "personal-details",
      tag: {
        classes: tagClass,
        text: tagText
      } if applicationValue(["completed", "choices"])
    }]
  }) }}

  <h2 class="govuk-heading-m govuk-!-font-size-27 govuk-!-margin-top-4">About you</h2>
  {{ appTaskList({
    classes: "govuk-!-margin-bottom-8",
    items: [{
      text: "Personal details",
      href: applicationPath + "/personal-details" + ("/review" if applicationValue(["candidate"])),
      id: "personal-details",
      tag: {
        classes: "app-tag--" + ("amended" if status == "amending" else "completed"),
        text: "Edited" if status == "amending" else "Completed"
      } if applicationValue("candidate")
    }, {
      text: "Contact details",
      href: applicationPath + "/contact-details" + ("/review" if applicationValue(["contact-details", "address"])),
      id: "contact-details",
      tag: {
        classes: tagClass,
        text: tagText
      } if applicationValue(["contact-details", "address"])
    }, {
      text: "Work history",
      href: applicationPath + "/work-history" + ("/review" if applicationValue("work-history")),
      id: "work-history",
      tag: {
        classes: tagClass,
        text: tagText
      } if applicationValue(["completed", "work-history"])
    }, {
      text: "Volunteering with children and young people",
      href: applicationPath + "/school-experience" + ("/review" if applicationValue("school-experience")),
      id: "school-experience",
      tag: {
        classes: tagClass,
        text: tagText
      } if applicationValue(["completed", "school-experience"])
    }, {
     text: "Training with a disability",
     href: applicationPath + "/disability" + ("/review" if applicationValue("disability")),
     id: "disability",
     tag: {
       classes: tagClass,
       text: tagText
     } if applicationValue("disability")
   }]
  }) }}

  <h2 class="govuk-heading-m govuk-!-font-size-27 govuk-!-margin-bottom-2">Qualifications</h2>
  {{ appTaskList({
    classes: "govuk-!-margin-bottom-8",
    items: [{
      text: "Degree",
      href: applicationPath + "/degree" + ("/review" if applicationValue(["degree"]) else "/add"),
      id: "degree",
      tag: {
        classes: tagClass,
        text: tagText
      } if applicationValue(["completed", "degree"])
    }, {
      text: "Maths GCSE or equivalent",
      href: applicationPath + "/gcse/maths" + ("/review" if applicationValue(["gcse", "maths"])),
      id: "maths-gcse",
      tag: {
        classes: tagClass,
        text: tagText
      } if applicationValue(["gcse", "maths"])
    }, {
      text: "English GCSE or equivalent",
      href: applicationPath + "/gcse/english" + ("/review" if applicationValue(["gcse", "english"])),
      id: "english-gcse",
      tag: {
        classes: tagClass,
        text: tagText
      } if applicationValue(["gcse", "english"])
    }, {
      text: "Science GCSE or equivalent",
      href: applicationPath + "/gcse/science" + ("/review" if applicationValue(["gcse", "science"])),
      id: "science-gcse",
      tag: {
        classes: tagClass,
        text: tagText
      } if applicationValue(["gcse", "science"])
    } if hasPrimaryChoices() or applicationValue(["gcse", "science"]), {
      text: "Other relevant academic and non-academic qualifications",
      href: applicationPath + "/other-qualifications" + ("/review" if applicationValue(["other-qualifications"]) else "/add"),
      id: "other-qualifications",
      tag: {
        classes: tagClass,
        text: tagText
      } if applicationValue(["completed", "other-qualifications"])
    }]
  }) }}

  <h2 class="govuk-heading-m govuk-!-font-size-27 govuk-!-margin-bottom-2">Personal statement and interview</h2>
  {{ appTaskList({
    classes: "govuk-!-margin-bottom-8",
    items: [{
      text: "Why do you want to be a teacher?",
      href: applicationPath + "/personal-statement" + ("/review" if applicationValue(["personal-statement"])),
      id: "personal-statement",
      tag: {
        classes: tagClass,
        text: tagText
      } if applicationValue(["personal-statement"])
    }, {
      text: "Your knowledge about the subject you want to teach",
      href: applicationPath + "/subject-knowledge" + ("/review" if applicationValue(["subject-knowledge"])),
      id: "subject-knowledge",
      tag: {
        classes: tagClass,
        text: tagText
      } if applicationValue(["subject-knowledge"])
    }, {
      text: "Interview preferences",
      href: applicationPath + "/interview" + ("/review" if applicationValue(["interview"])),
      id: "interview",
      tag: {
        classes: tagClass,
        text: tagText
      } if applicationValue(["interview"])
    }]
  }) }}

  <h2 class="govuk-heading-m govuk-!-font-size-27">References</h2>
  {% if status == "amending" %}
    <p class="govuk-body">You can’t change your choice of referees after you’ve submitted your application.</p>
  {% endif %}
  {{ appTaskList({
    classes: "govuk-!-margin-bottom-8",
    items: [{
      text: "Referees",
      href: applicationPath + "/references" + ("/review" if applicationValue(["referees"])),
      id: "references",
      tag: {
        classes: "app-tag--" + ("completed" if status == "started" else ("submitted" if status == "amending")),
        text: "Completed" if status == "started" else ("Submitted" if status == "amending")
      } if applicationValue(["referees"])
    }]
  }) }}

  <h2 class="govuk-heading-m govuk-!-font-size-27">Review and submit</h2>
  {{ appTaskList({
    classes: "govuk-!-margin-bottom-8",
    items: [{
      text: reviewText,
      href: applicationPath + "/review",
      id: "review"
    }]
  }) }}
{% endblock %}

{% block secondary %}
  {{ appRelated({
    title: "Application in progress",
    content: {
      html: "Last saved on " + ("now" | date("d MMMM yyyy")) + " at " + ("now" | date("tt"))
    }
  }) }}

  {{ appRelated({
    title: "Need help?",
    content: {
      html: "Call <a href=\"https://getintoteaching.education.gov.uk/\">Get into Teaching</a> on Freephone 0800 389 2500 or chat to an adviser using their <a href=\"https://getintoteaching.education.gov.uk/lp/live-chat\">online chat service</a> between 8am and 8pm, Monday to Friday"
    }
  }) }}
{% endblock %}
