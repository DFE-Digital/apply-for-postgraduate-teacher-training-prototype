{% extends "_content-wide.njk" %}
{% set applicationPath = '/application/' + applicationId %}
{% set title = "Review your application" %}
{% set referrer = applicationPath + "/review" %}

{% block pageNavigation %}
  {{ govukBackLink({ href: "/application/" + applicationId, text: 'Back to application' }) }}
{% endblock %}

{% block primary %}
{% set courseDetailsHtml %}
  {% if applicationValue("courses") %}
    {% include "_includes/review-courses.njk" %}
    {% if courses | length <= 3 %}
      {{ govukButton({
        classes: "govuk-!-font-size-16 govuk-!-padding-top-1 govuk-!-padding-bottom-1 govuk-button--secondary",
        text: "Add another course",
        href: applicationPath + "/course/add"
      }) }}
    {% endif %}
  {% else %}
    {{ govukButton({
      classes: "govuk-button--secondary govuk-!-font-size-16 govuk-!-padding-top-1 govuk-!-padding-bottom-1",
      text: "Add course",
      href: applicationPath + "/course/add"
    }) }}
  {% endif %}
{% endset %}

{% set personalDetailsHtml %}
  {% include "_includes/review-personal-details.njk" %}
{% endset %}

{% set contactDetailsHtml %}
  {% include "_includes/review-contact-details.njk" %}
{% endset %}

{% set qualificationsHtml %}
  <h3 class="govuk-heading-m">Degree(s)</h3>
  {% include "_includes/review-degree.njk" %}

  {% set gcses = data.applications[applicationId]["gcse"] | toArray %}
  {% for gcse in gcses %}
    <h3 class="govuk-heading-m">{{ gcse.id | capitalize }} GCSE or equivalent</h3>
    {% include "_includes/review-gcse.njk" %}
  {% endfor %}

  <h3 class="govuk-heading-m">Other relevant qualifications</h3>
  {% include "_includes/review-other-qualifications.njk" %}
  {{ govukSummaryList({
    rows: [{
      key: {
        text: "Is there anything youâ€™d like to tell us about your qualifications?"
      },
      value: {
        text: (applicationValue(["qualifications", "additional"]) | default("Not entered")) | nl2br | safe
      },
      actions: {
        classes: "govuk-!-padding-right-2",
        items: [{
          href: applicationPath + "/qualifications?referrer=" + referrer,
          text: "Change",
          visuallyHiddenText: "additional detail"
        }]
      }
    }]
  }) }}
{% endset %}

{% set subjectKnowledgeHtml %}
  {% include "_includes/review-subject-knowledge.njk" %}
{% endset %}

{% set workHistoryHtml %}
  {% include "_includes/review-work-history.njk" %}
{% endset %}

{% set schoolExperienceHtml %}
  {% include "_includes/review-school-experience.njk" %}
{% endset %}

{% set referencesHtml %}
  {% include "_includes/review-references.njk" %}
{% endset %}

{% set vocationHtml %}
  {% include "_includes/review-vocation.njk" %}
{% endset %}

{% set interviewHtml %}
  {% include "_includes/review-interview.njk" %}
{% endset %}

  {{ govukAccordion({
    id: "review",
    items: [{
      heading: {
        text: "Courses"
      },
      content: {
        html: courseDetailsHtml
      }
    }, {
      heading: {
        text: "Personal details"
      },
      content: {
        html: personalDetailsHtml
      }
    }, {
      heading: {
        text: "Contact details"
      },
      content: {
        html: contactDetailsHtml
      }
    }, {
      heading: {
        text: "Academic qualifications"
      },
      content: {
        html: qualificationsHtml
      }
    }, {
      heading: {
        text: "Knowledge about the subject you want to teach"
      },
      content: {
        html: subjectKnowledgeHtml
      }
    }, {
      heading: {
        text: "Work history"
      },
      content: {
        html: workHistoryHtml
      }
    }, {
      heading: {
        text: "School experience and volunteering with young people"
      },
      content: {
        html: schoolExperienceHtml
      }
    }, {
      heading: {
        text: "Why you want to be a teacher"
      },
      content: {
        html: vocationHtml
      }
    }, {
      heading: {
        text: "References"
      },
      content: {
        html: referencesHtml
      }
    }, {
      heading: {
        text: "Interview preferences"
      },
      content: {
        html: interviewHtml
      }
    }]
  }) }}

  {{ govukButton({
    text: "Continue",
    href: applicationPath + "/submit"
  }) }}
{% endblock %}
