{% extends "_form.njk" %}

{% set applicationPath = "/application/" + applicationId %}
{% set degrees = applicationValue(["degree"]) | toArray %}
{% set firstDegree = degrees[0].id == id %}
{% set international = applicationValue(["degree", id, "provenance"]) == "international" %}
{% set undergraduateDegree = applicationValue(["degree", id, "type-uk"]) | isUndergraduateDegree %}
{% if international %}
  {% set title = "Have you completed this degree?" %}
{% else %}
  {% set title = "What grade is your degree?" %}
{% endif %}

{% block pageNavigation %}
  {{ govukBackLink({
    href: paths.back
  }) }}
{% endblock %}

{% block primary %}
  {% set predictedGradeHtml %}
    {{ govukInput({
      label: {
        text: "Please give details of your predicted grade."
      },
      hint: {
        text: "Predicted grades must be validated by an academic referee in the â€˜References' section."
      },
      classes: "govuk-input--width-10"
    } | decorateApplicationAttributes(["degree", id, "grade-predicted"])) }}
  {% endset %}

  {% set otherGradeHtml %}
    {{ govukInput({
      label: {
        text: "Enter your degree grade"
      },
      classes: "govuk-input--width-10"
    } | decorateApplicationAttributes(["degree", id, "grade-other"])) }}
  {% endset %}

  {% if international %}
    {{ govukRadios({
      items: [{
        text: "Yes",
        conditional: {
          html: otherGradeHtml
        }
      }, {
        divider: "or"
      }, {
        value: "Pending",
        text: ("I am still studying for my degree" if firstDegree else "I am still studying for this degree"),
        conditional: {
          html: predictedGradeHtml
        }
      }]
    } | decorateApplicationAttributes(["degree", id, "grade"])) }}
  {% elif undergraduateDegree %}
    {{ govukRadios({
      items: [{
        value: "First-class honours",
        text: "First-class honours"
      }, {
        value: "Upper second-class honours (2:1)",
        text: "Upper second-class honours (2:1)"
      }, {
        value: "Lower second-class honours (2:2)",
        text: "Lower second-class honours (2:2)"
      }, {
        value: "Third-class honours",
        text: "Third-class honours"
      }, {
        value: "Fourth-class honours",
        text: "Fourth-class honours"
      }, {
        text: "Unclassified"
      }, {
        text: "Aegrotat"
      }, {
        text: "Pass"
      }, {
        text: "Ordinary degree"
      }, {
        text: "General degree"
      }, {
        text: "Other",
        conditional: {
          html: otherGradeHtml
        }
      }, {
        divider: "or"
      }, {
        value: "Pending",
        text: ("I am still studying for my degree" if firstDegree else "I am still studying for this degree"),
        conditional: {
          html: predictedGradeHtml
        }
      }]
    } | decorateApplicationAttributes(["degree", id, "grade"])) }}
  {% else %}
    {{ govukRadios({
      items: [{
        text: "Destinction"
      }, {
        text: "Merit"
      }, {
        text: "Pass"
      }, {
        text: "Not applicable"
      }, {
        text: "Unknown"
      }, {
        text: "Other",
        conditional: {
          html: otherGradeHtml
        }
      }, {
        divider: "or"
      }, {
        value: "Pending",
        text: "I am still studying for this degree",
        conditional: {
          html: predictedGradeHtml
        }
      }]
    } | decorateApplicationAttributes(["degree", id, "grade"])) }}
  {% endif %}

  {{ govukButton({
    text: "Save and continue"
  }) }}
{% endblock %}
