{% extends "_form.njk" %}

{% set action = "edit" if applicationValue(["gcse", id, "type"]) else "add" %}
{% set subject = (id | capitalize) if id == "english" else id %}
{% set title = (action | capitalize) + " " + subject + " GCSE grade 4 (C) or above, or equivalent" %}

{% block pageNavigation %}
  {% if referrer %}
    {{ govukBackLink({
      href: referrer
    }) }}
  {% else %}
    {{ govukBackLink({
      href: "/application/" + applicationId,
      text: "Back to application"
    }) }}
  {% endif %}
{% endblock %}

{% block primary %}
  {% if id == "science" %}
    <p class="givuk-body">If you have more than one science GCSE, choose one of your highest graded to enter here and add the rest in the ‘Other relevant qualifications’ section.</p>
  {% endif %}

  {% set otherUkConditionalHtml %}
    {{ govukInput({
      label: {
        text: "Enter type of qualification"
      }
    } | decorateApplicationAttributes(["gcse", id, "type-uk"])) }}
  {% endset %}

  {% set nonUkConditionalHtml %}
    {{ govukInput({
      label: {
        text: "Enter type of qualification"
      }
    } | decorateApplicationAttributes(["gcse", id, "type-non-uk"])) }}
    {{ appAutocomplete({
      label: {
        text: "In which country did you gain this qualification?"
      },
      items: countries
    } | decorateApplicationAttributes(["gcse", id, "country"])) }}
    {{ govukInput({
      label: {
        text: "What was the awarding organisation?"
      }
    } | decorateApplicationAttributes(["gcse", id, "award-org"])) }}
  {% endset %}

  {% set missingConditionalHtml %}
    {{ govukCharacterCount({
      label: {
        html: "If you are already on your way to gaining this qualification, give us details."
      },
      hint: {
        html: "You can still apply for teacher training if you are missing this qualification or its equivalent. However, it will need to be in place by the start of your course. For advice, contact your chosen training provider or <a href=\"https://getintoteaching.education.gov.uk/get-help-and-support/\">Get into teaching</a>."
      },
      maxwords: 200,
      rows: 12
    } | decorateApplicationAttributes(["gcse", id, "missing"])) }}
  {% endset -%}

  {{ govukRadios({
    fieldset: {
      legend: {
        text: "Type of qualification",
        classes: "govuk-label--m"
      },
      attributes: {
        "data-module": "clear-hidden"
      }
    },
    items: [{
      text: "GCSE"
    }, {
      text: "GCE O Level"
    }, {
      text: "Scottish Higher"
    }, {
      text: "Other UK qualification",
      conditional: {
        html: otherUkConditionalHtml
      }
    }, {
      text: "Non-UK qualification",
      conditional: {
        html: nonUkConditionalHtml
      }
    } if data.flags.international_qualifications, {
      divider: "or"
    }, {
      text: "I don’t have this qualification yet",
      conditional: {
        html: missingConditionalHtml
      }
    }]
  } | decorateApplicationAttributes(["gcse", id, "type"])) }}

  {{ govukButton({
    text: "Continue"
  }) }}
{% endblock %}

{% block pageScripts %}
  <script src="/public/javascripts/autocomplete.min.js"></script>
  <script>
    accessibleAutocomplete.enhanceSelectElement({
      defaultValue: '{{ applicationValue(["gcse", id, "country"]) }}',
      selectElement: document.querySelector('#gcse-{{ id }}-country')
    })
  </script>
{% endblock %}
