{% extends "_form.njk" %}

{% set applicationPath = "/application/" + applicationId %}
{% set parent = "Work history" %}
{% set action = "edit" if applicationValue(["work-history", id]) else "add" %}
{% set title = (action | capitalize) + " job" %}
{% set formaction = "/application/" + applicationId + "/work-history-2/" + id %}


{% block pageNavigation %}
  {% if referrer %}
    {{ govukBackLink({
      href: referrer
    }) }}
  {% else %}
    {{ govukBackLink({
      href: applicationPath + "/work-history-2/review"
    }) }}
  {% endif %}
{% endblock %}

{% block primary %}

  {{ govukInput({
    label: {
      text: "Job title",
      classes: "govuk-label--m"
    }
  } | decorateApplicationAttributes(["work-history", id, "role"])) }}

  {{ govukInput({
    label: {
      text: "Name of employer",
      classes: "govuk-label--m"
    }
  } | decorateApplicationAttributes(["work-history", id, "org"])) }}

  {% set partTimeHtml %}
    {{ govukCharacterCount({
      label: {
        text: "Give details about your working pattern",
        classes: "govuk-label--s"
      },
      hint: {
        text: "For example: ‘20 hours per week’"
      },
      maxwords: 50,
      threshold: 75,
      rows: 2
    } | decorateApplicationAttributes(["work-history", id, "part-time-details"])) }}
  {% endset -%}

  {{ govukRadios({
    fieldset: {
      legend: {
        text: "Was this job full time or part time?",
        classes: "govuk-fieldset__legend--m"
      }
    },
    hint: {
      text: "Select ‘Full time’ if you usually worked at least 35 hours a week"
    },
    items: [{
      text: "Full time"
    }, {
      text: "Part time"
    }]
  } | decorateApplicationAttributes(["work-history", id, "type"])) }}

  {{ govukDateInput({
    fieldset: {
      legend: {
        text: "Start date",
        classes: "govuk-fieldset__legend--m"
      }
    },
    hint: {
      text: "For example, 5 2018"
    },
    namePrefix: id + "-start-date",
    items: [{
      label: "Month",
      name: "month",
      value: (applicationValue(["work-history", id, "start-date"]) or start or "") | date('L'),
      classes: "govuk-input--width-2"
    }, {
      label: "Year",
      name: "year",
      value: (applicationValue(["work-history", id, "start-date"]) or start or "") | date('yyyy'),
      classes: "govuk-input--width-4"
    }]
  } | decorateApplicationAttributes(["work-history", id, "start-date"])) }}

  {{ govukDateInput({
    fieldset: {
      legend: {
        text: "End date (leave blank if this is your current role)",
        classes: "govuk-fieldset__legend--m"
      }
    },
    hint: {
      text: "For example, 5 2019"
    },
    namePrefix: id + "-end-date",
    items: [{
      label: "Month",
      name: "month",
      value: (applicationValue(["work-history", id, "end-date"]) or ""),
      classes: "govuk-input--width-2"
    }, {
      label: "Year",
      name: "year",
      value: (applicationValue(["work-history", id, "end-date"]) or ""),
      classes: "govuk-input--width-4"
    }]
  } | decorateApplicationAttributes(["work-history", id, "end-date"])) }}

  {{ govukRadios({
    fieldset: {
      legend: {
        text: "Did this job involve working in a school or with children?",
        classes: "govuk-fieldset__legend--m"
      }
    },
    items: [{
      text: "Yes"
    }, {
      text: "No"
    }]
  } | decorateApplicationAttributes(["work-history", id, "worked-with-children"])) }}

  {{ govukInput({
    type: "hidden",
    name: "applications[" + applicationId + "][work-history][" + id + "][category]",
    value: "job"
  }) }}

  {{ govukButton({
    text: "Save and continue"
  }) }}
{% endblock %}
