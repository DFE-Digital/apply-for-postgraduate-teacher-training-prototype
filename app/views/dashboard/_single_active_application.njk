{% from "govuk/components/inset-text/macro.njk" import govukInsetText %}

{% set firstChoice = choices | first %}
{% set firstChoiceProvider = providers[firstChoice["providerCode"]] %}
{% set firstChoiceCourse = firstChoiceProvider.courses[firstChoice.courseCode] %}

{% set item = firstChoice %}

<p class="govuk-body-l">You applied for the <a href="https://find-postgraduate-teacher-training.education.gov.uk/course/{{ provider.code }}/{{ firstChoiceCourse.code }}">{{ firstChoiceCourse["name"] }} ({{ firstChoiceCourse.code }}) course</a>  at {{ providers[firstChoice["providerCode"]]["name"] }}</p>

{% set statusHtml %}
{{ govukTag({
  classes: "app-tag " + firstChoice.status | statusClass,
  text: firstChoice.status
}) }}

{% if status == "post-interview" %}
  <p class="govuk-!-margin-top-3">You had an interview scheduled on 15 March 2020 at 11:00am</p>

{% elseif status == "future-interview" %}
  <p class="govuk-!-margin-top-3">You have an interview scheduled for 15 March 2020 at 11:00am</p>

  {% from "govuk/components/inset-text/macro.njk" import govukInsetText %}

  <p class="govuk-body govuk-!-margin-bottom-0">Details from provider:</p>

  {% set interviewDetails %}
    <p class="govuk-body">Leeds Trinity University
    Brownberrie Lane, Horsforth, Leeds. LS18 5HD</p>
    <p class="govuk-body">To get there, follow the A9 to junction 12 and then follow signs to the University teaching campus.</p>
    <p class="govuk-body">If you get lost, phone Emma on 07700900124</p>

  {% endset %}

  {{ govukInsetText({
    html: interviewDetails,
    classes: "govuk-!-margin-top-1"
  }) }}

{% else %}
{% endif %}

{% if status == "Awaiting decision" %}
  <p class="govuk-!-margin-top-3">The provider must make a decision by {{ 56 | nowPlusDays("d MMMM yyyy") }}.</p>
{% endif %}

{% if item.feedback %}

  {% set feedbackHtml %}

    {% if item.feedback.course_full %}
      <h2 class="govuk-heading-s">Course was full</h2>
      <p class="govuk-body">We're sorry to tell you the course you applied to was full</p>
    {% endif %}
    {% if item.feedback.rejected_by_default %}
      <p class="govuk-body">Provider did not respond in time</p>
    {% endif %}

    {% if item.feedback.quality_of_application %}
      <h4 class="govuk-heading-s govuk-!-margin-bottom-0">Quality of application</h4>

      {% if item.feedback.quality_of_application.subject_knowledge %}
        <p class="govuk-body">Subject knowledge</p>
        <p class="govuk-body">{{ item.feedback.quality_of_application.subject_knowledge }}</p>
      {% endif %}
    {% endif %}

    {% if item.feedback.qualifications %}
      <h4 class="govuk-heading-s govuk-!-margin-bottom-0">Qualifications</h4>

      {% if item.feedback.qualifications.degree_does_not_meet_requirements %}
        <p class="govuk-body">Your degree does not meet the course requirements.</p>
      {% endif %}
    {% endif %}

    {% if item.feedback.interested_in_future_applications %}
      <h4 class="govuk-heading-s govuk-!-margin-bottom-0">Future applications</h4>
      <p class="govuk-body">The provider would be interested in future applications from you.</p>
    {% endif %}
  {% endset %}

  <p class="govuk-body govuk-!-margin-top-3">Feedback from provider:</p>
  <div class="govuk-inset-text  govuk-!-margin-top-0">
    {{ feedbackHtml | safe }}
  </div>

{% endif  %}

{% endset %}


{{ govukSummaryList({
  classes: "govuk-summary-list--no-border",
  rows: [{
    key: {
      text: "Status"
    },
    value: {
      html: statusHtml
    },
    actions: {}
  },
  {
    key: { text: "Contact details" },
    value: { html: "0113 4871777 <br> <a href=\"mailto:info@gorsescitt.org.uk\">info@gorsescitt.org.uk</a>" }
  }]
}) }}

<p class="govuk-body"><a href="#" class="govuk-link">View your application</a></p>

