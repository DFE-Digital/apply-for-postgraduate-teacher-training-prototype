{% set references = applicationValue('referees') | toArray %}
{% set applicationPath = '/application/' + applicationId %}
{% if references.length >= 1 %}
  {% for item in references %}
    {% set typeRow = {
      key: {
        text: "Reference type"
      },
      value: {
        text: item.type
      },
      actions: {
        items: [{
          href: applicationPath + "/references/type/" + item.id + "?referrer=" + referrer,
          text: "Change",
          visuallyHiddenText: "referee"
        }]
      }
    } %}
    {% set nameRow = {
      key: {
        text: (item.id | capitalize) + " referee"
      },
      value: {
        text: item.name
      },
      actions: {
        items: [{
          href: applicationPath + "/references/details/" + item.id + "?referrer=" + referrer,
          text: "Change",
          visuallyHiddenText: "referee"
        }]
      }
    } %}
    {% set emailRow = {
      key: {
        text: "Email"
      },
      value: {
        text: item.email
      },
      actions: {
        items: [{
          href: applicationPath + "/references/details/" + item.id + "?referrer=" + referrer,
          text: "Change",
          visuallyHiddenText: "referee"
        }]
      }
    } %}
    {% set relationshipRow = {
      key: {
        text: "Relationship"
      },
      value: {
        text: item.relationship
      },
      actions: {
        items: [{
          href: applicationPath + "/references/details/" + item.id + "?referrer=" + referrer,
          text: "Change",
          visuallyHiddenText: "referee"
        }]
      }
    } %}
    {% set characterRow = {
      key: {
        text: "Reason for providing a character reference"
      },
      value: {
        text: item["character-explanation"]
      },
      actions: {
        items: [{
          href: applicationPath + "/references/details/" + item.id + "?referrer=" + referrer,
          text: "Change",
          visuallyHiddenText: "referee"
        }]
      }
    } %}
    {% if item["character-explanation"] %}
      {{ govukSummaryList({
        classes: "app-summary",
        rows: [nameRow, emailRow, typeRow, relationshipRow, characterRow]
      }) }}
    {% else %}
      {{ govukSummaryList({
        classes: "app-summary",
        rows: [nameRow, emailRow, typeRow, relationshipRow]
      }) }}
    {% endif %}
  {% endfor %}
{% else %}
  <p class="govuk-body">No references entered</p>
{% endif %}
