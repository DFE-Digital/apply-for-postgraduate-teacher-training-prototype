{% for item in choices %}
  {% set provider = providers[item.providerCode] %}
  {% set course = provider.courses[item.courseCode] %}
  {% set courseHtml %}
    {% include "_includes/item/choice.njk" %}
  {% endset %}

  {% set hasOffer = item.status == "offer" %}
  {% set canRespond = hasOffer and canMakeDecision %}
  {% set hasResponded =
    (item.status == "withdrawn")
    or (item.status == "accepted")
    or (item.status == "declined")
    or (item.status == "rejected")
  %}

  {{ appSummaryCard({
    classes: "govuk-!-margin-bottom-6",
    headingLevel: 3,
    titleText: provider.name,
    actions: {
      items: [{
        href: applicationPath + "/choices/" + item.id + "/delete?referrer=" + referrer,
        text: "Delete choice"
      } if canAmend, {
        href: applicationPath + "/" + item.id + "/withdraw?referrer=" + referrer,
        text: "Withdraw"
      } if canWithdraw and not hasResponded and not hasOffer, {
        href: applicationPath + "/" + item.id + "/accept?referrer=" + referrer,
        text: "Accept offer"
      } if canRespond and not hasResponded, {
        href: applicationPath + "/" + item.id + "/decline?referrer=" + referrer,
        text: "Decline offer"
      } if canRespond and not hasResponded]
    } if canAmend or canWithdraw or canRespond,
    html: courseHtml
  }) }}
{% endfor %}
