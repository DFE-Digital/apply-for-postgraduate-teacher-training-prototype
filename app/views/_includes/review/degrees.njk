{% set applicationPath = "/application/" + applicationId %}
{% set choice = applicationValue(["choices"]) | toArray | first %}
{% set provider = choice.providerCode | getProvider %}
{% set degrees = applicationValue(["degree"]) | toArray %}

{% if applicationValue(["completed", "degree"]) %}
  {{ appSuggestion({
    title: provider.name + " asks for a minimum of a 2:1 at degree level. Your degree grade is a 2:2.",
    content: {
      html: "Most training providers will not accept applications that do not meet their criteria.\n\nSome training providers will look to other parts of your application to assess your suitability for teaching. Make sure you have entered all of your qualifications, and been clear about why you want to teach in your personal statement." | markdown
    },
    actions: {
      items: [{
        text: "Contact the provider",
        href: "#"
      }, {
        text: "Choose a different course",
        href: applicationPath + "/choices/review?referrer=" + referrer
      }]
    }
  }) }}
{% elif showIncomplete %}
  {{ appSuggestion({
    id: "degree",
    title: "Degree section not marked as completed",
    warning: true if errorList,
    actions: {
      items: [{
        text: "Enter your degree",
        href: applicationPath + "/degree/add?referrer=" + referrer
      }]
    }
  }) }}
{% endif %}

{{ govukButton({
  text: "Add another degree",
  classes: "govuk-button--secondary",
  href: applicationPath + "/degree/add"
}) }}

{% set degrees = degrees | selectattr("id") %}
{% for item in degrees %}
  {% set summaryCardHtml %}{% include "_includes/item/degree.njk" %}{% endset %}
  {% set degreeType = (item.typeUk or item.typeNonUk) + (" (Hons)" if (item.grade and item.grade.includes("honours"))) %}
  {{ appSummaryCard({
    classes: "govuk-!-margin-bottom-6",
    headingLevel: 3,
    titleText: degreeType + " " + item.subject,
    actions: {
      items: [{
        href: applicationPath + "/degree/" + item.id + "/delete?referrer=" + referrer,
        text: "Delete degree"
      }]
    } if canAmend,
    html: summaryCardHtml
  }) }}
{% endfor %}
